<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>INSWING - ìŠ¤ìœ™ íˆìŠ¤í† ë¦¬</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #0ea5e9 0, #020617 45%, #020617 100%);
      color: #e5e7eb;
      min-height: 100vh;
      padding: 1.5rem;
    }
    
    .container {
      max-width: 800px;
      margin: 0 auto;
    }
    
    .header {
      text-align: center;
      margin-bottom: 2rem;
    }
    
    .logo-mark {
      display: inline-block;
      padding: 0.3rem 0.8rem;
      border-radius: 999px;
      background: linear-gradient(135deg, #0ea5e9, #22c55e);
      color: #020617;
      font-weight: 800;
      font-size: 1.2rem;
      letter-spacing: 0.14em;
      margin-bottom: 1rem;
    }
    
    h1 {
      font-size: 1.8rem;
      margin-bottom: 0.5rem;
    }
    
    .desc {
      color: #cbd5e1;
      font-size: 0.9rem;
    }
    
    .actions {
      display: flex;
      gap: 0.8rem;
      justify-content: center;
      margin-bottom: 2rem;
    }
    
    .btn {
      padding: 0.7rem 1.5rem;
      border-radius: 999px;
      border: none;
      font-weight: 600;
      font-size: 0.9rem;
      cursor: pointer;
      transition: transform 0.16s ease-out, box-shadow 0.16s ease-out;
      text-decoration: none;
      display: inline-block;
    }
    
    .btn-primary {
      background: #f97316;
      color: #111827;
    }
    
    .btn-secondary {
      background: rgba(15, 23, 42, 0.9);
      color: #e5e7eb;
      border: 1px solid rgba(148, 163, 184, 0.7);
    }
    
    .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 20px rgba(15, 23, 42, 0.6);
    }
    
    .status {
      text-align: center;
      font-size: 0.9rem;
      color: #cbd5e1;
      margin-bottom: 1rem;
    }
    
    .empty-state {
      text-align: center;
      padding: 4rem 2rem;
      background: rgba(15, 23, 42, 0.9);
      border-radius: 1.2rem;
      border: 1px solid rgba(148, 163, 184, 0.4);
    }
    
    .empty-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
    }
    
    .empty-text {
      font-size: 1.1rem;
      color: #94a3b8;
      margin-bottom: 1.5rem;
    }
    
    .card-list {
      display: grid;
      gap: 1rem;
    }
    
    .swing-card {
      background: rgba(15, 23, 42, 0.9);
      border-radius: 1rem;
      padding: 1.5rem;
      border: 1px solid rgba(148, 163, 184, 0.4);
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .swing-card:hover {
      border-color: #0ea5e9;
      box-shadow: 0 8px 20px rgba(14, 165, 233, 0.3);
      transform: translateY(-2px);
    }
    
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }
    
    .card-date {
      font-weight: 600;
      color: #e5e7eb;
    }
    
    .card-badge {
      padding: 0.3rem 0.8rem;
      border-radius: 999px;
      background: rgba(14, 165, 233, 0.2);
      color: #0ea5e9;
      font-size: 0.8rem;
      font-weight: 600;
    }
    
    .card-info {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.8rem;
      margin-bottom: 1rem;
    }
    
    .info-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9rem;
    }
    
    .info-label {
      color: #94a3b8;
    }
    
    .info-value {
      color: #e5e7eb;
      font-weight: 500;
    }
    
    .feeling-badge {
      padding: 0.4rem 0.8rem;
      border-radius: 999px;
      background: rgba(249, 115, 22, 0.2);
      color: #f97316;
      font-size: 0.85rem;
      font-weight: 500;
      display: inline-block;
      margin-top: 0.5rem;
    }
    
    .card-metrics {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.6rem;
      padding-top: 1rem;
      border-top: 1px solid rgba(148, 163, 184, 0.3);
    }
    
    .metric-item {
      font-size: 0.85rem;
    }
    
    .metric-label {
      color: #94a3b8;
      margin-bottom: 0.2rem;
    }
    
    .metric-value {
      color: #22c55e;
      font-weight: 600;
      font-size: 1rem;
    }
    
    @media (max-width: 768px) {
      h1 { font-size: 1.5rem; }
      .actions { flex-direction: column; }
      .btn { width: 100%; }
      .card-info { grid-template-columns: 1fr; }
      .card-metrics { grid-template-columns: repeat(2, 1fr); }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <span class="logo-mark">INSWING</span>
      <h1>ë‚˜ì˜ ìŠ¤ìœ™ íˆìŠ¤í† ë¦¬</h1>
      <p class="desc">AI ë¶„ì„ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”</p>
    </div>

    <div class="actions">
      <a href="/app/upload.html" class="btn btn-primary">
        ìƒˆ ìŠ¤ìœ™ ì—…ë¡œë“œ
      </a>
      <button onclick="loadHistory()" class="btn btn-secondary">
        ìƒˆë¡œê³ ì¹¨
      </button>
    </div>

    <div id="status" class="status"></div>
    <div id="list"></div>
  </div>

  <script src="/app/js/app.js"></script>
  <script>
    requireLogin();

    const listEl = document.getElementById('list');
    const statusEl = document.getElementById('status');

    loadHistory();

    async function loadHistory() {
      statusEl.textContent = 'íˆìŠ¤í† ë¦¬ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...';
      listEl.innerHTML = '';
      
      try {
        const res = await apiFetch('/api/swings?limit=20&offset=0');
        if (!res.ok) throw new Error('ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨');
        
        const data = await res.json();
        const items = data.swings || [];

        statusEl.textContent = '';

        if (items.length === 0) {
          listEl.innerHTML = `
            <div class="empty-state">
              <div class="empty-icon">â›³</div>
              <div class="empty-text">ì•„ì§ ê¸°ë¡ëœ ìŠ¤ìœ™ì´ ì—†ìŠµë‹ˆë‹¤</div>
              <a href="/app/upload.html" class="btn btn-primary">
                ì²« ìŠ¤ìœ™ ì—…ë¡œë“œí•˜ê¸°
              </a>
            </div>
          `;
          return;
        }

        const feelingNames = {
          'LIGHT_SMOOTH': 'âœ¨ ê°€ë³ê³  ë¶€ë“œëŸ¬ì›€',
          'FAST': 'âš¡ ë¹ ë¥´ê³  ê°•í•¨',
          'TENSE': 'ğŸ˜° ê¸´ì¥ë˜ê³  ë»£ë»£í•¨',
          'UNSTABLE': 'ğŸŒ€ ë¶ˆì•ˆì •í•¨',
          'SOLID': 'ğŸ’ª íƒ„íƒ„í•˜ê³  ì•ˆì •ì '
        };

        listEl.innerHTML = `<div class="card-list">${items.map(item => {
          const created = new Date(item.created_at).toLocaleString('ko-KR', {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
          });
          
          const clubNames = {
            'driver': 'ë“œë¼ì´ë²„',
            'wood': 'ìš°ë“œ',
            'iron': 'ì•„ì´ì–¸',
            'wedge': 'ì›¨ì§€',
            'putter': 'í¼í„°'
          };
          
          const sideNames = {
            'front': 'ì •ë©´',
            'back': 'í›„ë©´',
            'side': 'ì¸¡ë©´'
          };
          
          const club = clubNames[item.club_type] || item.club_type;
          const side = sideNames[item.shot_side] || item.shot_side;
          
          const feelingText = item.feeling?.feeling_code 
            ? feelingNames[item.feeling.feeling_code] || 'ëŠë‚Œ ì„ íƒë¨'
            : 'ëŠë‚Œ ë¯¸ì„ íƒ';

          const feelingBadge = item.feeling?.feeling_code 
            ? `<div class="feeling-badge">${feelingText}</div>`
            : '';

          return `
            <div class="swing-card" onclick="goResult(${item.id})">
              <div class="card-header">
                <div class="card-date">${created}</div>
                <div class="card-badge">${club}</div>
              </div>
              
              <div class="card-info">
                <div class="info-item">
                  <span class="info-label">ì´¬ì˜:</span>
                  <span class="info-value">${side}</span>
                </div>
                <div class="info-item">
                  <span class="info-label">ë¶„ì„:</span>
                  <span class="info-value">ì™„ë£Œ âœ“</span>
                </div>
              </div>
              
              ${feelingBadge}
              
              <div class="card-metrics">
                <div class="metric-item">
                  <div class="metric-label">ë°±ìŠ¤ìœ™ ê°ë„</div>
                  <div class="metric-value">${item.metrics?.backswing_angle || '-'}Â°</div>
                </div>
                <div class="metric-item">
                  <div class="metric-label">ì„íŒ©íŠ¸ ì†ë„</div>
                  <div class="metric-value">${item.metrics?.impact_speed || '-'} km/h</div>
                </div>
                <div class="metric-item">
                  <div class="metric-label">íŒ”ë¡œìš°ìŠ¤ë£¨</div>
                  <div class="metric-value">${item.metrics?.follow_through_angle || '-'}Â°</div>
                </div>
                <div class="metric-item">
                  <div class="metric-label">ë°¸ëŸ°ìŠ¤</div>
                  <div class="metric-value">${item.metrics?.balance_score || '-'}</div>
                </div>
              </div>
            </div>
          `;
        }).join('')}</div>`;

      } catch (e) {
        console.error(e);
        statusEl.textContent = 'íˆìŠ¤í† ë¦¬ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
        listEl.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">âš ï¸</div>
            <div class="empty-text">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>
            <button onclick="loadHistory()" class="btn btn-secondary">
              ë‹¤ì‹œ ì‹œë„
            </button>
          </div>
        `;
      }
    }

    function goResult(id) {
      window.location.href = '/app/result.html?swing_id=' + id;
    }
  </script>
</body>
</html>