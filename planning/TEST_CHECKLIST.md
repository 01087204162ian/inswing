# 🧪 INSWING 통합 테스트 체크리스트

> **테스트 목적**: 전체 플로우 검증 및 버그 발견

---

## 📋 테스트 환경 준비

### 필수 확인 사항
- [ ] EC2 서버 정상 작동 확인
- [ ] `inswing-api` 서버 실행 중 (PM2)
- [ ] `inswing-ai` 서버 실행 중 (PM2)
- [ ] 데이터베이스 연결 정상
- [ ] S3/CloudFront 설정 확인
- [ ] Anthropic API 키 설정 확인 (`USE_AI_COACHING=true`)

### 서버 상태 확인 명령어
```bash
# PM2 상태 확인
pm2 status

# API 서버 로그 확인
pm2 logs inswing-api --lines 50

# AI 서버 로그 확인
pm2 logs inswing-ai --lines 50

# API 서버 헬스 체크
curl https://api.inswing.ai/health

# AI 서버 헬스 체크
curl http://localhost:5000/health
```

---

## 🎯 테스트 시나리오

### 1. 전체 플로우 테스트 (업로드 → 분석 → 결과)

#### 1.1 정상 스윙 업로드
- [ ] **준비**: 실제 골프 스윙 영상 준비 (전체 몸이 보이는 영상)
- [ ] **업로드 페이지 접속**: `/app/upload.html`
- [ ] **로그인 확인**: 자동 로그인 또는 수동 로그인
- [ ] **영상 선택**: 클럽 종류, 촬영 방향 선택 후 영상 파일 선택
- [ ] **업로드 시작**: "업로드 및 분석 시작" 버튼 클릭
- [ ] **진행률 확인**: 
  - [ ] 진행률 바 표시 (0% → 100%)
  - [ ] 단계별 메시지 표시:
    - "영상 업로드 중..." (0-30%)
    - "AI가 스윙을 분석하는 중..." (30-70%)
    - "코치가 피드백을 작성하는 중..." (70-100%)
- [ ] **결과 페이지 이동**: 자동으로 `/app/result.html?id=XXX`로 이동
- [ ] **결과 확인**:
  - [ ] 비디오 재생 가능
  - [ ] 메트릭 표시 (백스윙 각도, 임팩트 속도 등)
  - [ ] AI 코칭 표시 (타이핑 애니메이션)
  - [ ] "Claude AI 코칭" 배지 표시
  - [ ] 키워드 태그 표시

**예상 소요 시간**: 30-60초

---

#### 1.2 느낌 저장 테스트
- [ ] **결과 페이지에서**: 느낌 버튼 선택 (완벽했어요/괜찮았어요/보통이에요/아쉬웠어요)
- [ ] **메모 입력**: 간단한 메모 작성 (선택)
- [ ] **저장 버튼 클릭**: "느낌 저장" 버튼
- [ ] **저장 확인**: "저장되었습니다" 메시지 표시
- [ ] **페이지 새로고침**: 저장된 느낌이 유지되는지 확인

---

#### 1.3 코칭 재생성 테스트
- [ ] **결과 페이지에서**: "🔄" 다시 생성 버튼 클릭
- [ ] **로딩 확인**: "새로운 코칭을 생성하는 중" 메시지 표시
- [ ] **새 코칭 확인**: 
  - [ ] 새로운 코칭 텍스트 표시 (타이핑 애니메이션)
  - [ ] 키워드 태그 업데이트
  - [ ] 토스트 메시지 표시 ("새로운 코칭이 생성되었습니다")
- [ ] **DB 업데이트 확인**: 페이지 새로고침 후 새 코칭이 유지되는지 확인

---

#### 1.4 히스토리 확인
- [ ] **히스토리 페이지 접속**: `/app/history.html`
- [ ] **리스트 확인**:
  - [ ] 업로드한 스윙이 리스트에 표시됨
  - [ ] AI 코칭 미리보기 표시 (60자 제한)
  - [ ] "🤖 Claude AI 코칭" 헤더 표시
  - [ ] 날짜, 클럽, 방향 정보 표시
  - [ ] 점수 표시
  - [ ] 태그 표시 (드라이버, 정면, 루틴 등)
- [ ] **스윙 클릭**: 리스트 항목 클릭 시 결과 페이지로 이동

---

### 2. 다양한 케이스 테스트

#### 2.1 좋은 스윙 (높은 점수)
- [ ] **조건**: 전체 몸이 보이고, 큰 백스윙, 안정적인 스윙
- [ ] **예상 결과**: 
  - [ ] 종합 점수 70점 이상
  - [ ] 긍정적인 AI 코칭 메시지
  - [ ] 키워드: "밸런스", "템포", "안정감" 등

---

#### 2.2 나쁜 스윙 (낮은 점수)
- [ ] **조건**: 불안정한 스윙, 머리 흔들림, 작은 백스윙
- [ ] **예상 결과**:
  - [ ] 종합 점수 40점 이하
  - [ ] 개선점을 제시하는 AI 코칭
  - [ ] 키워드: "머리 고정", "밸런스" 등

---

#### 2.3 느낌과 데이터 불일치
- [ ] **시나리오**: 
  1. 스윙 업로드 (점수 50점)
  2. 느낌: "완벽했어요" 선택
  3. 메모: "오늘 정말 좋았어요!"
- [ ] **예상 결과**:
  - [ ] AI 코칭이 느낌과 데이터를 모두 반영
  - [ ] "완벽하게 느껴졌지만, 실제 데이터는..." 같은 문구 포함 가능

---

#### 2.4 스윙이 아닌 영상 (에러 처리)
- [ ] **조건**: 일반 동영상, 스크린 골프 아바타, 사람이 작게 보이는 영상
- [ ] **예상 결과**:
  - [ ] "스윙 동작을 감지하지 못했습니다" 에러 메시지
  - [ ] 토스트 메시지로 표시
  - [ ] 사용자 친화적 안내 메시지
  - [ ] 더미 데이터 생성되지 않음

---

#### 2.5 AI 서버 장애 시나리오
- [ ] **준비**: `inswing-ai` 서버 중지 (`pm2 stop inswing-ai`)
- [ ] **테스트**: 스윙 업로드 시도
- [ ] **예상 결과**:
  - [ ] 타임아웃 또는 연결 오류 발생
  - [ ] Fallback으로 규칙 기반 코멘트 생성
  - [ ] 사용자에게는 정상적으로 결과 표시
  - [ ] 에러 로그 기록
- [ ] **복구**: `pm2 start inswing-ai` 후 재테스트

---

### 3. 에러 처리 테스트

#### 3.1 파일 크기 초과
- [ ] **조건**: 500MB 이상의 영상 파일 업로드 시도
- [ ] **예상 결과**: 
  - [ ] "파일 크기가 너무 큽니다. 최대 500MB까지 업로드 가능합니다." 토스트 메시지
  - [ ] 업로드 진행되지 않음

---

#### 3.2 필수 항목 미입력
- [ ] **조건**: 클럽 종류 또는 촬영 방향 미선택
- [ ] **예상 결과**:
  - [ ] "클럽 종류를 선택해주세요." 또는 "촬영 방향을 선택해주세요." 토스트 메시지
  - [ ] 업로드 진행되지 않음

---

#### 3.3 네트워크 오류
- [ ] **조건**: 인터넷 연결 차단 후 업로드 시도
- [ ] **예상 결과**:
  - [ ] "인터넷 연결을 확인해주세요. 네트워크 오류가 발생했습니다." 토스트 메시지
  - [ ] 폼이 다시 표시됨

---

#### 3.4 인증 오류
- [ ] **조건**: 토큰 만료 또는 잘못된 토큰
- [ ] **예상 결과**:
  - [ ] 자동으로 로그인 페이지로 리다이렉트
  - [ ] "로그인이 필요합니다." 메시지

---

### 4. 성능 테스트

#### 4.1 응답 시간 측정
- [ ] **업로드 → 분석 완료**: ___ 초
- [ ] **AI 코칭 생성**: ___ 초
- [ ] **코칭 재생성**: ___ 초
- [ ] **히스토리 로드**: ___ 초

**목표**:
- 업로드 → 분석 완료: 30-60초 이내
- AI 코칭 생성: 2-5초 이내
- 코칭 재생성: 2-5초 이내
- 히스토리 로드: 1-2초 이내

---

#### 4.2 동시 업로드 테스트
- [ ] **조건**: 여러 사용자가 동시에 업로드
- [ ] **확인 사항**:
  - [ ] 서버 응답 정상
  - [ ] 데이터 충돌 없음
  - [ ] 메모리 사용량 정상

---

### 5. 로깅 확인

#### 5.1 AI 코칭 로그 확인
```bash
# EC2 서버에서
tail -n 50 ~/inswing-api/logs/ai-coaching.log
```
- [ ] 성공 로그 기록 확인
- [ ] 실패 로그 기록 확인
- [ ] 응답 시간 기록 확인

---

#### 5.2 성능 로그 확인
```bash
# EC2 서버에서
tail -n 50 ~/inswing-api/logs/performance.log
```
- [ ] 작업별 소요 시간 확인
- [ ] 병목 지점 파악

---

## 🐛 발견된 버그 기록

### 버그 #1
- **발생 위치**: 
- **증상**: 
- **재현 방법**: 
- **해결 방법**: 

---

## ✅ 테스트 완료 체크리스트

### 필수 테스트
- [ ] 정상 스윙 업로드 → 분석 → 결과 확인
- [ ] 느낌 저장 기능
- [ ] 코칭 재생성 기능
- [ ] 히스토리 표시
- [ ] 스윙이 아닌 영상 에러 처리
- [ ] 파일 크기 초과 에러 처리
- [ ] 네트워크 오류 처리

### 선택 테스트
- [ ] 좋은 스윙 케이스
- [ ] 나쁜 스윙 케이스
- [ ] 느낌과 데이터 불일치 케이스
- [ ] AI 서버 장애 시나리오
- [ ] 성능 측정
- [ ] 동시 업로드 테스트

---

## 📝 테스트 결과 요약

**테스트 일자**: _______________

**테스트자**: _______________

**전체 테스트 결과**: 
- [ ] ✅ 통과
- [ ] ⚠️ 부분 통과 (버그 발견)
- [ ] ❌ 실패

**발견된 주요 버그**:
1. 
2. 
3. 

**개선 사항**:
1. 
2. 
3. 

---

**다음 단계**: 발견된 버그 수정 후 재테스트

